import sqlite3
import sys
import os
cur = os.getcwd()
sys.path.append(cur)
from INFO.common import tables
from INFO.common import columns
from logger.sqljlog import logger as sqljlog

class Sqlite3DBMS:

    def __init__(self, database, tablename,column):
        self.database = database
        self.tablename = tablename
        self.conn = sqlite3.connect(database)
        self.cursor = self.conn.cursor()
        self.column = column

    def show_database_columns_info(self):
        try:
                
            self.cursor.execute(f"SELECT * FROM {self.tablename}")
            result = self.cursor.fetchall()
            for item in result:
                print(item)
                return item
        except sqlite3.OperationalError as exc:
            errmsg = str(exc)
            errmsg += "\n the above error message occurred while interacting with sqlite database."
            sqljlog.error(errmsg)

    
# obj = Sqlite3DBMS("your_database.db","your_table",None)
# obj._show_database_columns_info()